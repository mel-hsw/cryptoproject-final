2025-11-30 23:57:20,454 - __main__ - INFO - Starting Coinbase WebSocket Ingestor
2025-11-30 23:57:20,455 - __main__ - INFO - Trading pairs: ['BTC-USD']
2025-11-30 23:57:20,455 - __main__ - INFO - Kafka topic: ticks.raw
2025-11-30 23:57:20,455 - __main__ - INFO - ✓ Connected to Kafka at localhost:9092
2025-11-30 23:57:20,455 - __main__ - INFO - Writing raw data to data/raw/ticks_BTCUSD_20251130_235720.ndjson
2025-11-30 23:57:20,455 - __main__ - INFO - Starting ingestion (press Ctrl+C to stop)
2025-11-30 23:57:20,459 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-30 23:57:20,460 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-30 23:57:20,600 - websocket - INFO - Websocket connected
2025-11-30 23:57:20,600 - __main__ - INFO - WebSocket connected to wss://advanced-trade-ws.coinbase.com
2025-11-30 23:57:20,600 - __main__ - INFO - Sending subscription: {'type': 'subscribe', 'product_ids': ['BTC-USD'], 'channel': 'ticker'}
2025-11-30 23:57:20,600 - __main__ - INFO - Subscribed to ticker channel for ['BTC-USD']
2025-11-30 23:57:20,600 - __main__ - INFO - Subscribed to heartbeats
2025-11-30 23:57:20,626 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-30 23:57:20,626 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-30 23:57:20,627 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-11-30 23:57:22,158 - __main__ - INFO - Processed 10 messages (5.87 msg/s)
2025-11-30 23:57:23,750 - __main__ - INFO - Processed 20 messages (6.07 msg/s)
2025-11-30 23:57:25,406 - __main__ - INFO - Processed 30 messages (6.06 msg/s)
2025-11-30 23:57:27,657 - __main__ - INFO - Processed 40 messages (5.55 msg/s)
2025-11-30 23:57:29,159 - __main__ - INFO - Processed 50 messages (5.74 msg/s)
2025-11-30 23:57:30,657 - __main__ - INFO - Processed 60 messages (5.88 msg/s)
2025-11-30 23:57:34,263 - __main__ - INFO - Processed 70 messages (5.07 msg/s)
2025-11-30 23:57:36,747 - __main__ - INFO - Processed 80 messages (4.91 msg/s)
2025-11-30 23:57:39,492 - __main__ - INFO - Processed 90 messages (4.73 msg/s)
2025-11-30 23:57:43,582 - __main__ - INFO - Processed 100 messages (4.32 msg/s)
2025-11-30 23:57:45,661 - __main__ - INFO - Processed 110 messages (4.36 msg/s)
2025-11-30 23:57:48,410 - __main__ - INFO - Processed 120 messages (4.29 msg/s)
2025-11-30 23:57:50,255 - __main__ - INFO - Processed 130 messages (4.36 msg/s)
2025-11-30 23:57:52,158 - __main__ - INFO - Processed 140 messages (4.42 msg/s)
2025-11-30 23:57:54,158 - __main__ - INFO - Processed 150 messages (4.45 msg/s)
2025-11-30 23:57:56,909 - __main__ - INFO - Processed 160 messages (4.39 msg/s)
2025-11-30 23:57:58,750 - __main__ - INFO - Processed 170 messages (4.44 msg/s)
2025-11-30 23:58:00,987 - __main__ - INFO - Processed 180 messages (4.44 msg/s)
2025-11-30 23:58:02,909 - __main__ - INFO - Processed 190 messages (4.48 msg/s)
2025-11-30 23:58:05,494 - __main__ - INFO - Processed 200 messages (4.44 msg/s)
2025-11-30 23:58:07,158 - __main__ - INFO - Processed 210 messages (4.50 msg/s)
2025-11-30 23:58:08,658 - __main__ - INFO - Processed 220 messages (4.56 msg/s)
2025-11-30 23:58:10,658 - __main__ - INFO - Processed 230 messages (4.58 msg/s)
2025-11-30 23:58:12,657 - __main__ - INFO - Processed 240 messages (4.60 msg/s)
2025-11-30 23:58:15,245 - __main__ - INFO - Processed 250 messages (4.56 msg/s)
2025-11-30 23:58:16,997 - __main__ - INFO - Processed 260 messages (4.60 msg/s)
2025-11-30 23:58:19,158 - __main__ - INFO - Processed 270 messages (4.60 msg/s)
2025-11-30 23:58:21,470 - __main__ - INFO - Processed 280 messages (4.59 msg/s)
2025-11-30 23:58:23,156 - __main__ - INFO - Processed 290 messages (4.63 msg/s)
2025-11-30 23:58:24,909 - __main__ - INFO - Processed 300 messages (4.65 msg/s)
2025-11-30 23:58:26,693 - __main__ - INFO - Processed 310 messages (4.68 msg/s)
2025-11-30 23:58:28,244 - __main__ - INFO - Processed 320 messages (4.72 msg/s)
2025-11-30 23:58:30,159 - __main__ - INFO - Processed 330 messages (4.73 msg/s)
2025-11-30 23:58:32,409 - __main__ - INFO - Processed 340 messages (4.73 msg/s)
2025-11-30 23:58:34,680 - __main__ - INFO - Processed 350 messages (4.72 msg/s)
2025-11-30 23:58:36,500 - __main__ - INFO - Processed 360 messages (4.73 msg/s)
2025-11-30 23:58:38,674 - __main__ - INFO - Processed 370 messages (4.73 msg/s)
2025-11-30 23:58:40,409 - __main__ - INFO - Processed 380 messages (4.75 msg/s)
2025-11-30 23:58:42,250 - __main__ - INFO - Processed 390 messages (4.77 msg/s)
2025-11-30 23:58:43,660 - __main__ - INFO - Processed 400 messages (4.81 msg/s)
2025-11-30 23:58:46,252 - __main__ - INFO - Processed 410 messages (4.78 msg/s)
2025-11-30 23:58:48,158 - __main__ - INFO - Processed 420 messages (4.79 msg/s)
2025-11-30 23:58:49,909 - __main__ - INFO - Processed 430 messages (4.81 msg/s)
2025-11-30 23:58:51,657 - __main__ - INFO - Processed 440 messages (4.82 msg/s)
2025-11-30 23:58:53,909 - __main__ - INFO - Processed 450 messages (4.82 msg/s)
2025-11-30 23:58:56,658 - __main__ - INFO - Processed 460 messages (4.78 msg/s)
2025-11-30 23:58:59,908 - __main__ - INFO - Processed 470 messages (4.73 msg/s)
2025-11-30 23:59:02,158 - __main__ - INFO - Processed 480 messages (4.72 msg/s)
2025-11-30 23:59:04,750 - __main__ - INFO - Processed 490 messages (4.70 msg/s)
2025-11-30 23:59:06,658 - __main__ - INFO - Processed 500 messages (4.71 msg/s)
2025-11-30 23:59:08,657 - __main__ - INFO - Processed 510 messages (4.71 msg/s)
2025-11-30 23:59:10,907 - __main__ - INFO - Processed 520 messages (4.71 msg/s)
2025-11-30 23:59:12,910 - __main__ - INFO - Processed 530 messages (4.71 msg/s)
2025-11-30 23:59:14,658 - __main__ - INFO - Processed 540 messages (4.73 msg/s)
2025-11-30 23:59:16,411 - __main__ - INFO - Processed 550 messages (4.74 msg/s)
2025-11-30 23:59:17,746 - __main__ - INFO - Processed 560 messages (4.77 msg/s)
2025-11-30 23:59:19,408 - __main__ - INFO - Processed 570 messages (4.79 msg/s)
2025-11-30 23:59:21,001 - __main__ - INFO - Processed 580 messages (4.81 msg/s)
2025-11-30 23:59:22,497 - __main__ - INFO - Processed 590 messages (4.83 msg/s)
2025-11-30 23:59:24,657 - __main__ - INFO - Processed 600 messages (4.83 msg/s)
2025-11-30 23:59:25,010 - __main__ - INFO - Received signal 15, initiating graceful shutdown...
2025-11-30 23:59:25,023 - __main__ - INFO - Received signal 15, initiating graceful shutdown...
2025-11-30 23:59:34,948 - __main__ - INFO - WebSocket closed: None - None
2025-11-30 23:59:34,948 - __main__ - INFO - Total messages processed: 601
2025-11-30 23:59:34,948 - __main__ - INFO - Starting graceful cleanup. Total messages processed: 601
2025-11-30 23:59:34,948 - __main__ - INFO - Flushing Kafka producer...
2025-11-30 23:59:34,948 - __main__ - INFO - Closing Kafka producer...
2025-11-30 23:59:34,949 - kafka.producer.kafka - INFO - <KafkaProducer client_id=kafka-python-producer-1 transactional_id=None>: Closing the Kafka producer with 10 secs timeout.
2025-11-30 23:59:34,949 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-11-30 23:59:34,950 - __main__ - INFO - ✓ Kafka producer closed
2025-11-30 23:59:34,950 - __main__ - INFO - ✓ File handle closed
2025-11-30 23:59:34,950 - __main__ - INFO - Cleanup complete
