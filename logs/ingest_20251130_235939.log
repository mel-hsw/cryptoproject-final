2025-11-30 23:59:39,729 - __main__ - INFO - Starting Coinbase WebSocket Ingestor
2025-11-30 23:59:39,729 - __main__ - INFO - Trading pairs: ['BTC-USD']
2025-11-30 23:59:39,729 - __main__ - INFO - Kafka topic: ticks.raw
2025-11-30 23:59:39,729 - __main__ - INFO - ✓ Connected to Kafka at localhost:9092
2025-11-30 23:59:39,729 - __main__ - INFO - Writing raw data to data/raw/ticks_BTCUSD_20251130_235939.ndjson
2025-11-30 23:59:39,729 - __main__ - INFO - Starting ingestion (press Ctrl+C to stop)
2025-11-30 23:59:39,733 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-30 23:59:39,733 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-30 23:59:39,860 - websocket - INFO - Websocket connected
2025-11-30 23:59:39,860 - __main__ - INFO - WebSocket connected to wss://advanced-trade-ws.coinbase.com
2025-11-30 23:59:39,860 - __main__ - INFO - Sending subscription: {'type': 'subscribe', 'product_ids': ['BTC-USD'], 'channel': 'ticker'}
2025-11-30 23:59:39,860 - __main__ - INFO - Subscribed to ticker channel for ['BTC-USD']
2025-11-30 23:59:39,860 - __main__ - INFO - Subscribed to heartbeats
2025-11-30 23:59:39,886 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-30 23:59:39,887 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-30 23:59:39,887 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-11-30 23:59:41,347 - __main__ - INFO - Processed 10 messages (6.18 msg/s)
2025-11-30 23:59:43,348 - __main__ - INFO - Processed 20 messages (5.53 msg/s)
2025-11-30 23:59:45,106 - __main__ - INFO - Processed 30 messages (5.58 msg/s)
2025-11-30 23:59:47,350 - __main__ - INFO - Processed 40 messages (5.25 msg/s)
2025-11-30 23:59:49,101 - __main__ - INFO - Processed 50 messages (5.34 msg/s)
2025-11-30 23:59:50,879 - __main__ - INFO - Processed 60 messages (5.38 msg/s)
2025-11-30 23:59:53,352 - __main__ - INFO - Processed 70 messages (5.14 msg/s)
2025-11-30 23:59:55,918 - __main__ - INFO - Processed 80 messages (4.94 msg/s)
2025-11-30 23:59:58,599 - __main__ - INFO - Processed 90 messages (4.77 msg/s)
2025-12-01 00:00:00,849 - __main__ - INFO - Processed 100 messages (4.73 msg/s)
2025-12-01 00:00:02,630 - __main__ - INFO - Processed 110 messages (4.80 msg/s)
2025-12-01 00:00:04,101 - __main__ - INFO - Processed 120 messages (4.92 msg/s)
2025-12-01 00:00:05,919 - __main__ - INFO - Processed 130 messages (4.96 msg/s)
2025-12-01 00:00:07,865 - __main__ - INFO - Processed 140 messages (4.98 msg/s)
2025-12-01 00:00:09,129 - __main__ - INFO - Processed 150 messages (5.10 msg/s)
2025-12-01 00:00:10,847 - __main__ - INFO - Processed 160 messages (5.14 msg/s)
2025-12-01 00:00:12,377 - __main__ - INFO - Processed 170 messages (5.21 msg/s)
2025-12-01 00:00:13,885 - __main__ - INFO - Processed 180 messages (5.27 msg/s)
2025-12-01 00:00:15,954 - __main__ - INFO - Processed 190 messages (5.25 msg/s)
2025-12-01 00:00:17,599 - __main__ - INFO - Processed 200 messages (5.28 msg/s)
2025-12-01 00:00:19,848 - __main__ - INFO - Processed 210 messages (5.23 msg/s)
2025-12-01 00:00:22,100 - __main__ - INFO - Processed 220 messages (5.19 msg/s)
2025-12-01 00:00:24,364 - __main__ - INFO - Processed 230 messages (5.15 msg/s)
2025-12-01 00:00:25,888 - __main__ - INFO - Processed 240 messages (5.20 msg/s)
2025-12-01 00:00:28,100 - __main__ - INFO - Processed 250 messages (5.17 msg/s)
2025-12-01 00:00:30,601 - __main__ - INFO - Processed 260 messages (5.11 msg/s)
2025-12-01 00:00:33,352 - __main__ - INFO - Processed 270 messages (5.04 msg/s)
2025-12-01 00:00:35,600 - __main__ - INFO - Processed 280 messages (5.01 msg/s)
2025-12-01 00:00:37,878 - __main__ - INFO - Processed 290 messages (4.99 msg/s)
2025-12-01 00:00:40,120 - __main__ - INFO - Processed 300 messages (4.97 msg/s)
2025-12-01 00:00:42,880 - __main__ - INFO - Processed 310 messages (4.91 msg/s)
2025-12-01 00:00:45,100 - __main__ - INFO - Processed 320 messages (4.90 msg/s)
2025-12-01 00:00:45,243 - __main__ - INFO - Received signal 15, initiating graceful shutdown...
2025-12-01 00:00:45,257 - __main__ - INFO - Received signal 15, initiating graceful shutdown...
2025-12-01 00:00:55,106 - __main__ - INFO - WebSocket closed: None - None
2025-12-01 00:00:55,107 - __main__ - INFO - Total messages processed: 320
2025-12-01 00:00:55,107 - __main__ - INFO - Starting graceful cleanup. Total messages processed: 320
2025-12-01 00:00:55,107 - __main__ - INFO - Flushing Kafka producer...
2025-12-01 00:00:55,107 - __main__ - INFO - Closing Kafka producer...
2025-12-01 00:00:55,107 - kafka.producer.kafka - INFO - <KafkaProducer client_id=kafka-python-producer-1 transactional_id=None>: Closing the Kafka producer with 10 secs timeout.
2025-12-01 00:00:55,108 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-12-01 00:00:55,108 - __main__ - INFO - ✓ Kafka producer closed
2025-12-01 00:00:55,108 - __main__ - INFO - ✓ File handle closed
2025-12-01 00:00:55,108 - __main__ - INFO - Cleanup complete
